/* dateUtil.js
 * Provides some additional functionality for manipulating and analyzing dates 
 */ 

/* howLongAgo 
 * Determines how long ago a certain date is from the current date object in a user friendly way 
 * For example, X minutes ago.
 * Returns an empty string if 'date' is later than the current date object 
 *
 * 'date' The date in the past
 */ 
Date.prototype.howLongAgo = function(date) { 
	var d = (typeof date == 'string') ? new Date(date) : date; 
	var diff = (this.getTime() - d.getTime()) / 1000; // diff in seconds 
	var dayDiff = Math.floor(diff / 86400); 
	var monthDiff = Math.floor(diff / 2629743.83); 
	var yearDiff = Math.floor(diff / 31556926); 
	
	if (dayDiff < 0) {
		return ''; 
	}
	
	if (dayDiff == 0) { 
		if (diff < 60) return 'Just now'; 
		if (diff < 120) return '1 minute ago'; 
		if (diff < 3600) return (Math.floor(diff / 60) + ' minutes ago'); 
		if (diff < 7200) return '1 hour ago'; 
		if (diff <  86400) return (Math.floor(diff / 3600) + " hours ago");
	} 
	else if (dayDiff == 1) return 'Yesterday';  
	else if (dayDiff < 7) return dayDiff + ' days ago'; 
	else if (dayDiff < 31) return (Math.ceil(dayDiff / 7) + ' weeks ago');
	else if (monthDiff == 1) return '1 month ago'; 
	else if (monthDiff < 12) return monthDiff + ' months ago';  
	else if (yearDiff == 1) return '1 year ago'; 
	else return yearDiff + ' years ago'; 
}